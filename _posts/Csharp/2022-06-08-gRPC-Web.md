---
title: "[gRPC-Web] Blazor를 이용하여 gRPC 서비스 클라이언트 호출 방법"
excerpt: "C# Blazor를 활용하여 Web에서 gRPC통신하기"

categories:
  - C#
  
tags:
  - [C#, gRPC, HTTP2, Blazor]

permalink: 

toc: true
toc_sticky: true
 
date: 2022-06-08
last_modified_at: 2022-06-08
---

## 😬 gRPC-WEB 활용하기 🏭👩‍🏭👨‍🏭
---

1시간동안 쳐다본 오류
```js
Grpc.Core.RpcException: 'Status(StatusCode="Internal", Detail="Content-Type 'application/grpc-web' is not supported.")'
```

<br>

---

서비스부분

> Startup.cs 추가
> 1. **[ConfigureServices]** 에서  **[service.addCors();]** 추가
>> .NET 6일경우 
> 2. **[Configure]** 에서 **[app.UseGrpcWeb();]** , **[app.UseCors();]** 를 추가한다.
>> **[app.UseRouting();]** 과 **[app.UseEndpoints()]** 사이에 추가해야한다.
> 3. **[EndPoints]** 에 **[endpoints.MapGrpcService<GreeterService>().EnableGrpcWeb();]** 
>> 서비스부분에 **[EnableGrpcWeb()]** 추가
> 

---

Blazor Web page 버튼함수부분

```csharp
    private void gRpc_Test()
    {
        var channel = GrpcChannel.ForAddress("http://localhost:50051"
        , new GrpcChannelOptions{
                HttpHandler = new GrpcWebHandler(new HttpClientHandler())
                ,
            });
        var client = new Greet.Greeter.GreeterClient(channel);
        var reply = client.SayHello(new Greet.HelloRequest {
           Name = "블레이저에서 요청" 
           });
        Console.WriteLine("Greeting: " + reply.Message);

    }
```

Console 출력부분

```js
Microsoft.AspNetCore.Routing.EndpointMiddleware: Information: Executed endpoint 'gRPC - /greet.Greeter/SayHello'
Microsoft.AspNetCore.Hosting.Diagnostics: Information: Request finished HTTP/2 POST http://localhost:50051/greet.Greeter/SayHello application/grpc-web - - 200 - application/grpc-web 7.0985ms
```

성공!
<br>



**Note:** `만들고나니 내것이 아니었다.` 